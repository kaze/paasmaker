<ul class="breadcrumb">
  <li><a href="/workspace/{{ workspace.id }}/applications">{{ workspace.name }}</a> <span class="divider">/</span></li>
  <li><a href="/application/{{ version_to_view.application.id }}">{{ version_to_view.application.name }}</a> <span class="divider">/</span></li>
  <li class="active">Version {{ version_to_view.version }}</li>
</ul>

<div class="router-stats well well-small" data-name="version" data-inputid="{{ version_to_view.id }}">Loading...</div>

<h1>
	Version {{ version_to_view.version }} of {{ version_to_view.application.name }}
</h1>

<div class="btn-toolbar">
	<div class="btn-group btn-group-header">
		{% if version_to_view.is_current %}
			<a href="#" class="btn btn-success disabled">
				<i class="icon-ok icon-white"></i> Current
			</a>
		{% else %}
			<a href="#" class="btn disabled">
				<i class="icon-minus"></i> Not current
			</a>
		{% end %}
		<a class="btn" href="/job/list/version/{{ version_to_view.id }}">All Jobs</a>
		<a class="btn" href="/job/list/version/{{ version_to_view.id }}?sub=cron">Crons</a>
	</div>
</div>

<ul>
	<li><b>State:</b> {{ version_to_view.state }}</li>
	<li><b>SCM:</b> {{ version_to_view.scm_name }}</li>
	{% set scm_params = version_to_view.scm_parameters %}
	{% if 'formatted_location' in scm_params %}
		<li><b>Original source location:</b> {{ scm_params['formatted_location'] }}</li>
	{% elif 'location' in version_to_view.scm_parameters %}
		<li><b>Original source location:</b> {{ scm_params['location'] }}</li>
	{% end %}
	<li><b>Package type:</b> {{ version_to_view.source_package_type }}</li>
</ul>

<h2>Instance Types</h2>
<table class="table table-striped table-bordered">
	<tr>
		<th>Name</th>
		<th>Runtime</th>
		<th>Quantity</th>
		<th>Exclusive</th>
		<th>Standalone</th>
		<th>Hostnames</th>
	</tr>
	{% for instance_type in version_to_view.instance_types %}
		<tr>
			<td>
				{{ instance_type.name }}
			</td>
			<td>
				{{ instance_type.runtime_name }}
			</td>
			<td>
				{{ instance_type.quantity }}
			</td>
			<td>
				{{ instance_type.exclusive }}
			</td>
			<td>
				{{ instance_type.standalone }}
			</td>
			<td>
				{% if not instance_type.standalone %}
					{% for hostname in instance_type.hostnames %}
						{% if version_to_view.is_current %}
							<a href="http://{{ hostname.hostname }}{{ frontend_domain_postfix }}/" target="_blank">
						{% end %}
							{{ hostname.hostname }}
						{% if version_to_view.is_current %}
							</a>
						{% end %}
						<br />
					{% end %}
					<a href="http://{{ instance_type.version_hostname(configuration) }}{{ frontend_domain_postfix }}" target="_blank">
						{{ instance_type.version_hostname(configuration) }}
					</a>
				{% else %}
					Standalone instance
				{% end %}
			</td>
		</tr>
	{% end %}
</table>

{% for instance_type in version_to_view.instance_types %}
	<h2>Instance type: {{ instance_type.name }}</h2>
	<table class="table table-striped table-bordered">
		<tr>
			<th>ID</th>
			<th>Node</th>
			<th>Port</th>
			<th>Created</th>
			<th>State</th>
		</tr>
		{% for instance in instance_type.instances %}
			<tr>
				<td>
					<code>{{ instance.instance_id[0:8] }}</code>
					<a href="#" class="toggle {{ instance.instance_id }}"></a>
				</td>
				<td>
					<a href="/node/{{ instance.node.id }}">{{ instance.node.name }}</a>
				</td>
				<td>
					{{ instance.port }}
				</td>
				<td>
					{{ instance.created.isoformat() }}
				</td>
				<td>
					<span class="instance-{{ instance.state }}">{{ nice_state(instance.state) }}</span>
				</td>
			</tr>
			<tr>
				<td colspan="5" class="instance-log-container {{ instance.instance_id }}" data-instance="{{ instance.instance_id }}">
				</td>
			</tr>
		{% end %}
	</table>
{% end %}

<h2>Manifest</h2>

<pre>{{ version_to_view.manifest }}</pre>