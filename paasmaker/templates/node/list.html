{% extends "../layout/main.html" %}

{% block pagetitle %}
	Nodes
{% end %}

{% block body %}
	<table class="table table-striped table-bordered">
		<tr>
			<th>ID</th>
			<th>Name</th>
			<th>Route</th>
			<th>Roles</th>
			<th>Last Heard</th>
			<th>Score</th>
			<th>State</th>
		</tr>
		{% for node in nodes %}
			<tr>
				<td>
					<code>{{ node.uuid[0:8] }}</code>
				</td>
				<td>
					{% if has_permission(PERMISSION.NODE_DETAIL_VIEW) %}<a href="/node/{{ node.id }}">{% end %}
						{{ node.name }}
					{% if has_permission(PERMISSION.NODE_DETAIL_VIEW) %}</a>{% end %}
				</td>
				<td>
					{{ node.route }}:{{ node.apiport }}
				</td>
				<td>
					{% if node.pacemaker %}Pacemaker{% end %}
					{% if node.heart %}Heart{% end %}
					{% if node.router %}Router{% end %}
				</td>
				<td>
					{{ "%0.2f" % node.updated_age() }}s
				</td>
				<td>
					{{ "%0.2f" % node.score }}
				</td>
				<td>
					<span class="node-{{ node.state }}">{{ nice_state(node.state) }}</span>
				</td>
			</tr>
		{% end %}
	</table>

	{% module Template("include/pagination.html", page_data=nodes_pagination) %}
{% end %}
